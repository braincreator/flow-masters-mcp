# üöÄ PRODUCTION READY: –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ + API –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## ‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. üìä –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–ª—è production)
- ‚úÖ **YandexMetrikaRobust** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å fallback —Ä–µ–∂–∏–º–æ–º
- ‚úÖ **CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏** –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ next.config.mjs
- ‚úÖ **Middleware** –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **Debug —Ä–µ–∂–∏–º** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –≤ production
- ‚úÖ **Standalone —Ä–µ–∂–∏–º** –≤–∫–ª—é—á–µ–Ω –¥–ª—è Docker

### 2. üîó API –ö–ª—é—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ **n8n API**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
- ‚úÖ **Crawl4AI API**: `braincoder_crawl4ai_token_2024`
- ‚úÖ **–Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ ID**: `98849829`

### 3. üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
- ‚úÖ –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `ApiTestComponent`
- ‚úÖ API —Ä–æ—É—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: `/api/test/n8n`, `/api/test/crawl4ai`, `/api/test/metrika`
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `/api-test`

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –í Coolify –¥–æ–±–∞–≤–∏—Ç—å:
```bash
# –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞
NEXT_PUBLIC_YANDEX_METRIKA_ID=98849829
NEXT_PUBLIC_METRIKA_DEBUG=false

# n8n API
N8N_API_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkYzFmNGY3Zi0zMzQ1LTRiNzQtOTM1OC1lYjEyZWU4MjdiNzUiLCJpc3MiOiJuOG4iLCJhdWQiOiJwdWJsaWMtYXBpIiwiaWF0IjoxNzUwMzE2MDk1fQ.54cWJ5_Lknv20HTq4mPspgHPFaLVcpAXLVFRRMgZ4tE
N8N_BASE_URL=https://n8n.flow-masters.ru

# Crawl4AI API
CRAWL4AI_API_TOKEN=braincoder_crawl4ai_token_2024
CRAWL4AI_BASE_URL=https://crawl4ai.flow-masters.ru
CRAWL4AI_INTERNAL_URL=http://192.168.0.4:11235

# Public URLs for client-side
NEXT_PUBLIC_N8N_BASE_URL=https://n8n.flow-masters.ru
NEXT_PUBLIC_CRAWL4AI_BASE_URL=https://crawl4ai.flow-masters.ru
```

## üöÄ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### 1. –ß–µ—Ä–µ–∑ Coolify (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)
```bash
# –ö–æ–¥ —É–∂–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, Coolify –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# –ò–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –≤ Coolify –ø–∞–Ω–µ–ª–∏
```

### 2. –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /path/to/flowmasters
git pull origin main
npm run build
npm start
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
1. –û—Ç–∫—Ä—ã—Ç—å https://flow-masters.ru
2. –û—Ç–∫—Ä—ã—Ç—å DevTools (F12) ‚Üí Console
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ `ERR_CONNECTION_REFUSED`
4. –ù–∞–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ: `‚úÖ Yandex Metrika initialized successfully`

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
1. –û—Ç–∫—Ä—ã—Ç—å https://flow-masters.ru/api-test
2. –ù–∞–∂–∞—Ç—å "üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã"
3. –í—Å–µ API –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å ‚úÖ —Å—Ç–∞—Ç—É—Å

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–µ
1. –í–æ–π—Ç–∏ –≤ [–Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫—É](https://metrika.yandex.ru)
2. –°—á–µ—Ç—á–∏–∫ 98849829
3. **–û—Ç—á–µ—Ç—ã** ‚Üí **–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å** ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏
curl -I https://flow-masters.ru | grep -i content-security

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
curl https://flow-masters.ru/metrika/tag.js

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker exec container_name env | grep METRIKA
```

### –ï—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API —Ä–æ—É—Ç—ã
curl https://flow-masters.ru/api/test/n8n
curl https://flow-masters.ru/api/test/crawl4ai
curl https://flow-masters.ru/api/test/metrika

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs container_name --tail 50
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ `ERR_CONNECTION_REFUSED` –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/test/*` endpoints
- ‚úÖ –î–∞–Ω–Ω—ã–µ –≤ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç
- ‚úÖ API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

### –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞:
- HTTP 5xx –æ—à–∏–±–∫–∏ –Ω–∞ API endpoints
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–µ > 1 —á–∞—Å–∞
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å n8n –∏–ª–∏ Crawl4AI API

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –í production –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
1. **–Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞** –±–µ–∑ –æ—à–∏–±–æ–∫ `ERR_CONNECTION_REFUSED`
2. **–û–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤** —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **Fallback —Ä–µ–∂–∏–º** –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
4. **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** —Å n8n –∏ Crawl4AI
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ `/api-test`

### üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ production:
- Debug —Ä–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω
- CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Standalone —Ä–µ–∂–∏–º –¥–ª—è Docker
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω—ã

---

üéâ **–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!**

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: https://flow-masters.ru/api-test
- –õ–æ–≥–∏: `docker logs container_name`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∞ + API endpoints
