# üõ°Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

## üìã –û–±–∑–æ—Ä

–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞—â–∏—â–∞—é—Ç –≤–∞—à —Å–∞–π—Ç –æ—Ç –∞—Ç–∞–∫, –Ω–æ –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—á–µ—Ç—á–∏–∫–æ–≤. –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é.

## üîç **X-Content-Type-Options: nosniff**

### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ:
```http
X-Content-Type-Options: nosniff
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **–ó–∞–ø—Ä–µ—â–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É "—É–≥–∞–¥—ã–≤–∞—Ç—å" MIME-—Ç–∏–ø** —Ñ–∞–π–ª–æ–≤
- **–ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å** –∑–∞–≥–æ–ª–æ–≤–∫—É `Content-Type`
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç MIME-sniffing –∞—Ç–∞–∫–∏**

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫—É:
- ‚úÖ **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ**: –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ JS —Ñ–∞–π–ª—ã
- ‚ö†Ô∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–¥–∞–µ—Ç JS —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º Content-Type
- üîß **–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ JS —Ñ–∞–π–ª—ã –æ—Ç–¥–∞—é—Ç—Å—è —Å `Content-Type: application/javascript`

## üö® **Content Security Policy (CSP) - –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**

### –ß—Ç–æ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É:

#### 1. **script-src –¥–∏—Ä–µ–∫—Ç–∏–≤–∞**
```http
Content-Security-Policy: script-src 'self'
```
‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã

‚úÖ **–†–µ—à–µ–Ω–∏–µ**:
```http
Content-Security-Policy: script-src 'self' 'unsafe-inline' 'unsafe-eval' 
  https://mc.yandex.ru 
  https://mc.webvisor.org 
  https://vk.com 
  https://ads.vk.com 
  https://www.googletagmanager.com
```

#### 2. **connect-src –¥–∏—Ä–µ–∫—Ç–∏–≤–∞**
```http
Content-Security-Policy: connect-src 'self'
```
‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç AJAX –∑–∞–ø—Ä–æ—Å—ã –∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º

‚úÖ **–†–µ—à–µ–Ω–∏–µ**:
```http
Content-Security-Policy: connect-src 'self' 
  https://mc.yandex.ru 
  https://mc.webvisor.org 
  https://metrika.yandex.ru 
  https://vk.com 
  https://ads.vk.com
```

#### 3. **img-src –¥–∏—Ä–µ–∫—Ç–∏–≤–∞**
```http
Content-Security-Policy: img-src 'self'
```
‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–∏–∫—Å–µ–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

‚úÖ **–†–µ—à–µ–Ω–∏–µ**:
```http
Content-Security-Policy: img-src 'self' data: https: 
  https://mc.yandex.ru 
  https://mc.webvisor.org 
  https://vk.com 
  https://ads.vk.com
```

## üîß **–î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏**

### **X-Frame-Options: DENY**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç iframe –≤–∏–¥–∂–µ—Ç—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SAMEORIGIN` –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CSP `frame-ancestors`

### **Referrer-Policy: no-referrer**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∏—Å—Ç–æ—á–Ω–∏–∫–µ —Ç—Ä–∞—Ñ–∏–∫–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `strict-origin-when-cross-origin`

### **Permissions-Policy**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- **–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑—Ä–µ—à–∏—Ç—å –Ω—É–∂–Ω—ã–µ API –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤

## üõ†Ô∏è **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º**

### 1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console
console.log('Yandex Metrika:', typeof window.ym)
console.log('VK Pixel:', typeof window.VK)
console.log('Google Analytics:', typeof window.gtag)
```

### 2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ CSP –æ—à–∏–±–æ–∫**
- –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console
- –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞: `Refused to load script... because it violates CSP`

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ Network**
- DevTools ‚Üí Network
- –§–∏–ª—å—Ç—Ä: JS
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

### 4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç-–¥–∞—à–±–æ—Ä–¥–∞**
```
https://your-domain.com/en/test/analytics
```

## ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CSP**

```http
Content-Security-Policy: 
  default-src 'self';
  script-src 'self' 'unsafe-inline' 'unsafe-eval' 
    https://mc.yandex.ru 
    https://mc.webvisor.org 
    https://vk.com 
    https://ads.vk.com 
    https://yastatic.net 
    https://www.googletagmanager.com 
    https://www.google-analytics.com;
  connect-src 'self' 
    https://mc.yandex.ru 
    https://mc.webvisor.org 
    https://yandex.ru 
    https://metrika.yandex.ru 
    https://vk.com 
    https://ads.vk.com 
    https://www.google-analytics.com 
    https://analytics.google.com 
    wss: ws:;
  img-src 'self' data: https: 
    https://mc.yandex.ru 
    https://mc.webvisor.org 
    https://yandex.ru 
    https://vk.com 
    https://ads.vk.com 
    https://www.google-analytics.com;
  style-src 'self' 'unsafe-inline' 
    https://yastatic.net 
    https://fonts.googleapis.com;
  font-src 'self' data: 
    https://yastatic.net 
    https://fonts.gstatic.com;
  frame-src 'self' 
    https://yandex.ru 
    https://metrika.yandex.ru 
    https://vk.com 
    https://ads.vk.com;
  object-src 'none';
  base-uri 'self';
  form-action 'self'
```

## üöÄ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

### 1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**
```javascript
// next.config.mjs
async headers() {
  return [
    {
      source: '/metrika/:path*',
      headers: [
        {
          key: 'Cache-Control',
          value: 'public, max-age=86400'
        }
      ]
    }
  ]
}
```

### 2. **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ DNS**
```html
<link rel="dns-prefetch" href="//mc.yandex.ru">
<link rel="dns-prefetch" href="//mc.webvisor.org">
<link rel="dns-prefetch" href="//vk.com">
<link rel="dns-prefetch" href="//ads.vk.com">
```

### 3. **Preconnect –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤**
```html
<link rel="preconnect" href="https://mc.webvisor.org">
<link rel="preconnect" href="https://vk.com">
```

## üîç **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞**

### 1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ CSP –Ω–∞—Ä—É—à–µ–Ω–∏–π**
```javascript
// –î–æ–±–∞–≤–∏—Ç—å –≤ CSP
Content-Security-Policy: ...; report-uri /api/csp-report
```

### 2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
setInterval(() => {
  if (!window.ym) {
    console.warn('Yandex Metrika not loaded')
  }
  if (!window.VK) {
    console.warn('VK Pixel not loaded')
  }
}, 30000)
```

### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã**
```javascript
// Cypress/Playwright —Ç–µ—Å—Ç
cy.window().should('have.property', 'ym')
cy.window().should('have.property', 'VK')
```

## üìä **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞**

- ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤**: 100% —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: < 2 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- ‚úÖ **CSP –æ—à–∏–±–∫–∏**: 0 –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤ –∫–æ–Ω—Å–æ–ª–∏
- ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã**: –î–æ—Å—Ç—É–ø–Ω—ã –≤ window —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥

## üÜò **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è**

### –ü—Ä–æ–±–ª–µ–º–∞: "Refused to load script"
**–ü—Ä–∏—á–∏–Ω–∞**: CSP –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω –≤ `script-src`

### –ü—Ä–æ–±–ª–µ–º–∞: "Mixed Content"
**–ü—Ä–∏—á–∏–Ω–∞**: HTTPS —Å–∞–π—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç HTTP —Ä–µ—Å—É—Ä—Å—ã
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ HTTPS —Å—Å—ã–ª–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "MIME type mismatch"
**–ü—Ä–∏—á–∏–Ω–∞**: –°–µ—Ä–≤–µ—Ä –æ—Ç–¥–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type
**–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö MIME —Ç–∏–ø–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
**–ü—Ä–∏—á–∏–Ω–∞**: –†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
**–†–µ—à–µ–Ω–∏–µ**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å CSP –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

## üîó **–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏**

- [CSP Evaluator](https://csp-evaluator.withgoogle.com/)
- [Security Headers Scanner](https://securityheaders.com/)
- [MDN CSP Reference](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
- [Yandex Metrica Documentation](https://yandex.ru/support/metrica/)
- [VK Ads Documentation](https://ads.vk.com/help)
