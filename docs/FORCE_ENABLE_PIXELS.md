# üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (30 —Å–µ–∫—É–Ω–¥)

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
   ```
   https://your-domain.com/en/test/analytics
   ```

2. **–ù–∞–∂–º–∏—Ç–µ –±–æ–ª—å—à—É—é –∫—Ä–∞—Å–Ω—É—é –∫–Ω–æ–ø–∫—É:**
   ```
   üöÄ –ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –í–°–ï –ü–ò–ö–°–ï–õ–ò
   ```

3. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   # –í —Ñ–∞–π–ª .env.local
   NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```bash
   npm run dev
   # –∏–ª–∏
   yarn dev
   ```

5. **–ì–æ—Ç–æ–≤–æ!** üéâ –í—Å–µ –ø–∏–∫—Å–µ–ª–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫.

---

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è**

1. **–°–æ–∑–¥–∞–π—Ç–µ/–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env.local`:**
   ```bash
   # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π
   NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
   
   # –í–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   NEXT_PUBLIC_YANDEX_METRIKA_ID=12345678
   NEXT_PUBLIC_VK_PIXEL_ID=12345678
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm run dev
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
   ```
   üöÄ FORCE MODE: Loading all pixels regardless of consent
   ```

---

## üîß –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º –≤–∫–ª—é—á–µ–Ω–∏–∏?

### **–í –∫–æ–¥–µ:**
- ‚úÖ **–ò–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** `isActive`, `gdprCompliant`, `userConsent`
- ‚úÖ **–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï –ø–∏–∫—Å–µ–ª–∏** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ **–û—Ç–∫–ª—é—á–∞—é—Ç—Å—è GDPR –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** –≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏** –¥–ª—è –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π

### **–í –∞–¥–º–∏–Ω–∫–µ (–ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏):**
- ‚úÖ **isActive: true** - –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è
- ‚úÖ **gdprCompliant: false** - —É–±–∏—Ä–∞—é—Ç—Å—è GDPR –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- ‚úÖ **pages: ['all']** - –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- ‚úÖ **loadPriority: 'high'** - –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### **1. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
```javascript
// –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
üöÄ FORCE MODE: Loading pixel Yandex Metrika (yandex_metrica) regardless of settings
üöÄ FORCE MODE: Loading pixel VK Pixel (vk) regardless of settings
```

### **2. –û–±—ä–µ–∫—Ç—ã –≤ window:**
```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
console.log('Yandex Metrika:', typeof window.ym)     // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 'function'
console.log('VK Pixel:', typeof window.VK)          // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 'object'
console.log('Google Analytics:', typeof window.gtag) // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 'function'
```

### **3. Network Tab:**
- –í—Å–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200
- –ù–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### **4. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:**
```
https://your-domain.com/en/test/analytics
```
- –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ‚úÖ –∑–µ–ª–µ–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏
- –°—Ç–∞—Ç—É—Å "FORCE MODE ON" –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–µ–Ω

---

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:**
```typescript
// –í –ª—é–±–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
<PixelManager
  currentPage="all"
  userConsent={true}
  forceLoad={true}  // üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
/>
```

### **–£—Å–ª–æ–≤–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ:**
```typescript
// –¢–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
const shouldForceLoad = process.env.NODE_ENV === 'development' || 
                       window.location.hostname === 'test.domain.com'

<PixelManager forceLoad={shouldForceLoad} />
```

### **API –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
```bash
# POST –∑–∞–ø—Ä–æ—Å –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π –≤ –∞–¥–º–∏–Ω–∫–µ
curl -X POST https://your-domain.com/api/pixels/force-activate

# GET –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
curl https://your-domain.com/api/pixels/force-activate
```

---

## üö® –í–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### **‚ö†Ô∏è GDPR Compliance:**
```
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –û–¢–ö–õ–Æ–ß–ê–ï–¢ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≥–ª–∞—Å–∏–π GDPR!
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ:
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –í —Ä–µ–≥–∏–æ–Ω–∞—Ö, –≥–¥–µ GDPR –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

### **‚ö†Ô∏è Production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
–í production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. –ü–æ–ª—É—á–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ cookie banner
2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–∏–∫—Å–µ–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FORCE MODE —Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π
```

### **‚ö†Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
```
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –∑–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –ø–∏–∫—Å–µ–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
- –ú–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏
```

---

## üîÑ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

### **1. –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
# –£–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ .env.local
# NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
```

### **2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:**
```bash
npm run dev
```

### **3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å GDPR –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
- –í–∫–ª—é—á–∏—Ç—å `gdprCompliant: true` –¥–ª—è –Ω—É–∂–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ `pages` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ –≤ development
NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
```

### **Staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º
NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
```

### **Production (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!):**
```bash
# –¢–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–∏–∫—Å–µ–ª–µ–π –∏–ª–∏ –ø–æ—Å–ª–µ GDPR —Å–æ–≥–ª–∞—Å–∏—è
# NEXT_PUBLIC_FORCE_LOAD_PIXELS=true
```

### **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```typescript
// –í–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
const forceLoad = Math.random() < 0.1 // 10% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### **–ï—Å–ª–∏ –ø–∏–∫—Å–µ–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏ JavaScript**
2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network Tab –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**
5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –Ω–∞ `/en/test/analytics`**

### **–õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:**
```javascript
// –í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
localStorage.setItem('debug', 'pixel-manager')
```

### **–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```javascript
// –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
console.log('Force mode:', process.env.NEXT_PUBLIC_FORCE_LOAD_PIXELS)
console.log('Analytics objects:', {
  ym: typeof window.ym,
  VK: typeof window.VK,
  gtag: typeof window.gtag
})
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `NEXT_PUBLIC_FORCE_LOAD_PIXELS=true` –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –°–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è "üöÄ FORCE MODE"
- [ ] –í—Å–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ window
- [ ] Network Tab –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤
- [ ] –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–µ–ª–µ–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏
- [ ] –°—Ç–∞—Ç—É—Å "FORCE MODE ON" –∞–∫—Ç–∏–≤–µ–Ω

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –í–°–ï –ø–∏–∫—Å–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ª—é–±—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫! üéâ**
