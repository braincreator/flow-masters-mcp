# –û—Ç—á–µ—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∫ –¥–µ–ø–ª–æ—é

## üìä –°—Ç–∞—Ç—É—Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: ‚úÖ –ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ

### ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

#### üéØ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Next.js 15 App Directory
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3 —Å–µ—Ä–≤–∏—Å–æ–≤**: Yandex Metrica, VK Pixel, Top.Mail.Ru (VK Ads)
- **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ VK Ads** - –≤–∞—à –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ Top.Mail.Ru –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
- **TypeScript —Ç–∏–ø–∏–∑–∞—Ü–∏—è** - –ø–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **React hooks** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- **FlexibleAnalyticsProvider** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç CMS, env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ä—É—á–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- **API endpoint** `/api/analytics-settings` - –≥–æ—Ç–æ–≤ –¥–ª—è CMS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Debug –ø–∞–Ω–µ–ª—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ development
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ CMS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **SSR –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º

#### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
src/lib/analytics/
‚îú‚îÄ‚îÄ types.ts              ‚úÖ –í—Å–µ —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ yandex-metrica.ts     ‚úÖ Yandex Metrica —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ vk-pixel.ts           ‚úÖ VK Pixel —Å–µ—Ä–≤–∏—Å  
‚îú‚îÄ‚îÄ top-mail-ru.ts        ‚úÖ Top.Mail.Ru (VK Ads) —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ provider.tsx          ‚úÖ React –ø—Ä–æ–≤–∞–π–¥–µ—Ä
‚îú‚îÄ‚îÄ hooks.ts              ‚úÖ React —Ö—É–∫–∏
‚îú‚îÄ‚îÄ cms-config.ts         ‚úÖ CMS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ index.ts              ‚úÖ –ì–ª–∞–≤–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç

src/providers/
‚îî‚îÄ‚îÄ FlexibleAnalyticsProvider.tsx ‚úÖ –ì–∏–±–∫–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä

src/components/analytics/
‚îú‚îÄ‚îÄ AnalyticsDebugPanel.tsx    ‚úÖ Debug –ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ AnalyticsExample.tsx       ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ VKAdsExample.tsx           ‚úÖ VK Ads –ø—Ä–∏–º–µ—Ä—ã

src/globals/
‚îî‚îÄ‚îÄ AnalyticsSettings.ts       ‚úÖ CMS –≥–ª–æ–±–∞–ª

src/app/api/analytics-settings/
‚îî‚îÄ‚îÄ route.ts                   ‚úÖ API endpoint
```

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **TypeScript –æ—à–∏–±–∫–∏** - –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
2. **–ò–º–ø–æ—Ä—Ç—ã** - –≤—Å–µ –ø—É—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. **Layout –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - FlexibleAnalyticsProvider –ø–æ–¥–∫–ª—é—á–µ–Ω
4. **API endpoint** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å fallback –∫ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
5. **Payload config** - –≥–ª–æ–±–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã)

1. **Sass warnings** - deprecation warnings –æ—Ç Payload CMS (–Ω–µ –Ω–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞)
2. **MongoDB –≤ –±–∏–ª–¥–µ** - –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º –±–∏–ª–¥–µ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
3. **CMS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è)

### üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

#### –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —Ä–∞–±–æ—Ç–∞–µ—Ç:
```env
# –î–æ–±–∞–≤–∏—Ç—å –≤ .env.local
NEXT_PUBLIC_YANDEX_METRIKA_ID=98849829
NEXT_PUBLIC_TOP_MAIL_RU_ID=3661858
NEXT_PUBLIC_VK_PIXEL_ID=your_vk_pixel_id
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:
```tsx
import { useAnalytics, useTopMailRu } from '@/lib/analytics'

function MyComponent() {
  const analytics = useAnalytics()
  const tmr = useTopMailRu() // –í–∞—à VK Ads –∫–æ–¥
  
  const handleClick = () => {
    // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
    analytics.trackEvent('button_click', { button: 'cta' })
    
    // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –¥–ª—è Top.Mail.Ru (–≤–∞—à –∫–æ–¥)
    tmr.goal('conversion', { value: 100 })
  }
}
```

### üìã –ü–ª–∞–Ω –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É** - debug –ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CMS** - –∑–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É ‚Üí Globals ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
3. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å API** - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ `/api/analytics-settings/route.ts`
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debug –ø–∞–Ω–µ–ª—å –∏ –ø—Ä–∏–º–µ—Ä—ã

### üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- **TypeScript –∫–æ–º–ø–∏–ª—è—Ü–∏—è**: ‚úÖ –ü—Ä–æ—Ö–æ–¥–∏—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã**: ‚úÖ –ö–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- **–ò–º–ø–æ—Ä—Ç—ã**: ‚úÖ –í—Å–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- **Layout**: ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- **API endpoint**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å fallback

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `docs/ANALYTICS_USAGE_GUIDE.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- `docs/MODERN_ANALYTICS_MIGRATION.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- `docs/ANALYTICS_CMS_ACTIVATION.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ CMS
- `src/lib/analytics/README.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≥–æ—Ç–æ–≤–∞ –∫ –¥–µ–ø–ª–æ—é!**

‚úÖ –ù–µ –ª–æ–º–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å  
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∞—à –∫–æ–¥ VK Ads (Top.Mail.Ru)  
‚úÖ –ò–º–µ–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É  
‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞  
‚úÖ –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è  

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –î–µ–ø–ª–æ–∏—Ç—å –º–æ–∂–Ω–æ —Å–º–µ–ª–æ!**

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞ CMS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.
