# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã FlowMasters

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**

### üìÅ **–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
- ‚úÖ `src/components/Layout/AnalyticsLayout.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–π layout –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚úÖ `src/components/PixelManager/index.tsx` - –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∏–∫—Å–µ–ª–µ–π
- ‚úÖ `src/components/Analytics/TrackableButton.tsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- ‚úÖ `src/components/Analytics/FormTracker.tsx` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º
- ‚úÖ `src/components/Analytics/ButtonTracker.tsx` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ `src/components/Analytics/index.ts` - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
- ‚úÖ `src/components/CookieConsent/index.tsx` - GDPR –±–∞–Ω–Ω–µ—Ä
- ‚úÖ `src/hooks/usePixelEvents.ts` - —Ö—É–∫–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- ‚úÖ `src/services/event.service.ts` - —Å–µ—Ä–≤–∏—Å —Å–æ–±—ã—Ç–∏–π
- ‚úÖ `src/services/whatsapp.service.ts` - WhatsApp —Å–µ—Ä–≤–∏—Å
- ‚úÖ `src/collections/Pixels/index.ts` - –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø–∏–∫—Å–µ–ª–µ–π
- ‚úÖ `src/collections/EventSubscriptions/index.ts` - –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ `src/collections/EventLogs/index.ts` - –ª–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π

### üóëÔ∏è **–£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (—Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞)**
- ‚ùå `src/components/Analytics/AnalyticsProvider.tsx` - –£–î–ê–õ–ï–ù
- ‚ùå `src/components/Analytics/VKPixel.tsx` - –£–î–ê–õ–ï–ù
- ‚ùå `src/components/Analytics/TopMailRu.tsx` - –£–î–ê–õ–ï–ù
- ‚ùå `src/components/YandexMetrika/YandexMetrikaRobust.tsx` - –£–î–ê–õ–ï–ù

### üîÑ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ layout**
- ‚úÖ `src/app/(frontend)/layout.tsx` - AnalyticsLayout –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ `src/app/(frontend)/[lang]/layout.tsx` - —Å—Ç–∞—Ä—ã–π AnalyticsProvider —É–¥–∞–ª–µ–Ω
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## üéØ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**

### üìä **–°–∏—Å—Ç–µ–º–∞ –ø–∏–∫—Å–µ–ª–µ–π**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API –ø–∏–∫—Å–µ–ª–µ–π
curl http://localhost:3000/api/pixels/active

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "pixels": [],
  "count": 0,
  "page": "all"
}
```

### üì± **WhatsApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
```bash
# –¢–µ—Å—Ç WhatsApp (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
curl -X POST http://localhost:3000/api/whatsapp/test \
  -H "Content-Type: application/json" \
  -d '{
    "phoneNumber": "+7 999 123-45-67",
    "message": "–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã"
  }'

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω):
{
  "error": "WhatsApp service not available"
}
```

### üîî **–°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
curl http://localhost:3000/api/events/subscriptions

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "subscriptions": [],
  "count": 0
}
```

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**

### 1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤**
```tsx
// –≠—Ç–æ—Ç –∏–º–ø–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
import { 
  CTAButton, 
  LeadForm, 
  usePixelEvents,
  TRACKING_EVENTS 
} from '@/components/Analytics'
```

### 2. **–¢–µ—Å—Ç TrackableButton**
```tsx
import { CTAButton } from '@/components/Analytics'

function TestPage() {
  return (
    <CTAButton 
      conversionType="lead"
      conversionValue={5000}
      onClick={() => console.log('Clicked!')}
    >
      –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞
    </CTAButton>
  )
}
```

### 3. **–¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è**
```html
<!-- –≠—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è -->
<button data-track>–ö–Ω–æ–ø–∫–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º</button>
<button class="cta-button">CTA –∫–Ω–æ–ø–∫–∞</button>
<button data-buy>–ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏</button>
<a href="tel:+79991234567">–¢–µ–ª–µ—Ñ–æ–Ω</a>
<a href="mailto:test@example.com">Email</a>
```

### 4. **–¢–µ—Å—Ç GDPR –±–∞–Ω–Ω–µ—Ä–∞**
- ‚úÖ –ë–∞–Ω–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–∏
- ‚úÖ –í—ã–±–æ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ localStorage
- ‚úÖ –ü–∏–∫—Å–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è

## üîç **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**

### üì± **DevTools Console**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
console.log('Analytics system loaded:', !!window.analyticsLoaded)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏–∫—Å–µ–ª–µ–π (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
console.log('VK Pixel:', !!window.VK)
console.log('Facebook Pixel:', !!window.fbq)
console.log('Google Analytics:', !!window.gtag)
console.log('Yandex Metrica:', !!window.ym)
```

### üç™ **LocalStorage**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ cookies
localStorage.getItem('cookie-consent')
localStorage.getItem('cookie-consent-timestamp')
```

### üåê **Network Tab**
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –∫ `/api/pixels/active` –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 200
- ‚úÖ –ü–∏–∫—Å–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è
- ‚úÖ –°–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω—ã –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –≤ `/api/pixels/active` (POST)

## üéõÔ∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∫–∏**

### üìä **Pixels Collection**
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Admin ‚Üí Marketing ‚Üí Pixels
2. –ù–∞–∂–∞—Ç—å "Create New"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∏–∫—Å–µ–ª—å:
   ```
   –ù–∞–∑–≤–∞–Ω–∏–µ: Test VK Pixel
   –¢–∏–ø: VK Pixel
   ID: VK-RTRG-TEST-12345
   –°—Ç—Ä–∞–Ω–∏—Ü—ã: –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   –ê–∫—Ç–∏–≤–µ–Ω: ‚úÖ
   ```
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ API

### üîî **Event Subscriptions**
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Admin ‚Üí Integrations ‚Üí Event Subscriptions
2. –ù–∞–∂–∞—Ç—å "Create New"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É:
   ```
   –ù–∞–∑–≤–∞–Ω–∏–µ: Test Notifications
   –°–æ–±—ã—Ç–∏—è: lead.created
   –ö–∞–Ω–∞–ª—ã: Email
   Email: test@example.com
   –ê–∫—Ç–∏–≤–Ω–∞: ‚úÖ
   ```
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ API

### üìù **Event Logs**
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Admin ‚Üí Integrations ‚Üí Event Logs
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–æ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö
3. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

## üö® **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è**

### ‚ùå **–û—à–∏–±–∫–∞: "Cannot find module '@/components/Analytics'"**
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª `src/components/Analytics/index.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### ‚ùå **–û—à–∏–±–∫–∞: "AnalyticsLayout is not defined"**
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç –≤ `src/app/(frontend)/layout.tsx`

### ‚ùå **–ü–∏–∫—Å–µ–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è**
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ cookies –≤ localStorage
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∏–∫—Å–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã –≤ –∞–¥–º–∏–Ω–∫–µ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API `/api/pixels/active`

### ‚ùå **–°–æ–±—ã—Ç–∏—è –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è**
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∏–∫—Å–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –∫ API

### ‚ùå **WhatsApp –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API `/api/whatsapp/test`

## ‚úÖ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏**

### üéØ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- [ ] AnalyticsLayout –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] GDPR –±–∞–Ω–Ω–µ—Ä –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- [ ] –ò–º–ø–æ—Ä—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ê–¥–º–∏–Ω–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–∏–∫—Å–µ–ª–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∏

### üöÄ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (data-track)
- [ ] TrackableButton –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è
- [ ] –°–∫—Ä–æ–ª–ª –∏ –≤—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è
- [ ] –í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è
- [ ] WhatsApp —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

### üìä **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
- [ ] –ü–∏–∫—Å–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- [ ] –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

---

**–ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚úÖ - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** üéâ

–í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ OPTIMIZATION_REPORT.md –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π.
